<html>
<head>
<title>Mesa Source Code Documentation</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head>
<body>
<div class="qindex">
<a class="qindex" href="../main/index.html">core</a> |
<a class="qindex" href="../glapi/index.html">glapi</a> |
<a class="qindex" href="../glsl/index.html">glsl</a> |
<a class="qindex" href="../nir/index.html">nir</a> |
<a class="qindex" href="../vbo/index.html">vbo</a> |
<a class="qindex" href="../math/index.html">math</a> |
<a class="qindex" href="../swrast/index.html">swrast</a> |
<a class="qindex" href="../swrast_setup/index.html">swrast_setup</a> |
<a class="qindex" href="../tnl/index.html">tnl</a> |
<a class="qindex" href="../tnl_dd/index.html">tnl_dd</a> |
<a class="qindex" href="../gbm/index.html">gbm</a> |
<a class="qindex" href="../i965/index.html">i965</a>
</div>
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_f13bc85843fa14191e0ad4a3a157cf60.html">compiler</a></li><li class="navelem"><a class="el" href="dir_4172b1ff1383a72421e897c24b01e6f0.html">glsl</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">lower_discard_flow.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implements the GLSL 1.30 revision 9 rule for fragment shader discard handling:  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;compiler/glsl_types.h&quot;</code><br />
<code>#include &quot;<a class="el" href="ir_8h.html">ir.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae62d74008babab15bb64ec5328e1fa76"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lower__discard__flow_8cpp.html#ae62d74008babab15bb64ec5328e1fa76">lower_discard_flow</a> (<a class="el" href="structexec__list.html">exec_list</a> *ir)</td></tr>
<tr class="separator:ae62d74008babab15bb64ec5328e1fa76"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implements the GLSL 1.30 revision 9 rule for fragment shader discard handling: </p>
<p>"Control flow exits the shader, and subsequent implicit or explicit derivatives are undefined when this control flow is non-uniform (meaning different fragments within the primitive take different control paths)."</p>
<p>There seem to be two conflicting things here. "Control flow exits
the shader" sounds like the discarded fragments should effectively jump to the end of the shader, but that breaks derivatives in the case of uniform control flow and causes rendering failure in the bushes in Unigine Tropics.</p>
<p>The question, then, is whether the intent was "loops stop at the
point that the only active channels left are discarded pixels" or "discarded pixels become inactive at the point that control flow
returns to the top of a loop". This implements the second interpretation. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ae62d74008babab15bb64ec5328e1fa76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae62d74008babab15bb64ec5328e1fa76">&sect;&nbsp;</a></span>lower_discard_flow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lower_discard_flow </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structexec__list.html">exec_list</a> *&#160;</td>
          <td class="paramname"><em>ir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>References <a class="el" href="ir__hv__accept_8cpp.html#ae09ad67f6b8034581e991d76bbc7d902">visit_list_elements()</a>.</p>

<p>Referenced by <a class="el" href="program_8h.html#afc0379dac600d4977ea2e7ae44096f1a">link_shaders()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.12
</small></address>
</body>
</html>
